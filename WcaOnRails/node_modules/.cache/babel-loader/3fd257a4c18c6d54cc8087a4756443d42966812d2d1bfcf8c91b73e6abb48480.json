{"ast":null,"code":"import _difference from \"lodash/difference\";\nimport _keyBy from \"lodash/keyBy\";\nimport 'leaflet/dist/leaflet.css';\n// https://github.com/smeijer/leaflet-geosearch/issues/151#issuecomment-347967474\nimport 'leaflet-geosearch/assets/css/leaflet.css';\nimport { Map as LeafletMap, TileLayer, Marker, Circle, Popup, Icon } from 'leaflet';\nimport { GeoSearchControl } from 'leaflet-geosearch';\nimport iconMarker2x from 'leaflet/dist/images/marker-icon-2x.png';\nimport iconMarker from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\nimport { railsEnv } from \"../wca-data.js.erb\";\nimport { redMarker, blueMarker } from \"./markers\";\nimport { searchProvider, userTileProvider } from \"./providers\";\n\n// Leaflet and webpack are not good friend, we need to require the images for\n// the assets to be properly setup.\n/* eslint no-underscore-dangle: \"off\" */\ndelete Icon.Default.prototype._getIconUrl;\nIcon.Default.mergeOptions({\n  iconRetinaUrl: iconMarker2x,\n  iconUrl: iconMarker,\n  shadowUrl: iconShadow\n});\nwindow.wca.searchAndPlaceOnMap = function (map, query) {\n  searchProvider.search({\n    query: query\n  }).then(function (allResults) {\n    if (allResults.length > 0) {\n      // Assume first result will be ok\n      var result = allResults[0];\n      new Marker({\n        lat: result.y,\n        lng: result.x\n      }, {\n        title: result.label\n      }).addTo(map).bindPopup(result.label).openPopup();\n      map.setView([result.y, result.x], 16);\n    } else {\n      new Popup().setLatLng([0, 0]).setContent('No location found for your query. Try with GPS coordinates.').openOn(map);\n    }\n  });\n};\n\n// Create a search input, removing any marker/popup added: we'll handle this ourselves\n// with the existing marker\nwindow.wca.createSearchInput = function (map) {\n  var searchControl = new GeoSearchControl({\n    provider: searchProvider,\n    showMarker: false,\n    showPopup: false,\n    style: 'bar',\n    retainZoomLevel: true,\n    autoClose: true,\n    searchLabel: 'Enter an address'\n  });\n  map.addControl(searchControl);\n  return searchControl;\n};\nwindow.wca.createCompetitionsMapLeaflet = function (elementId) {\n  var center = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [0, 0];\n  var iframeTrick = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var map = new LeafletMap(elementId, {\n    zoom: 2,\n    center: center\n  });\n  var provider = userTileProvider;\n  var layer = new TileLayer(provider.url, {\n    maxZoom: 19,\n    attribution: provider.attribution\n  });\n  // To avoid timeout issue on *.tile.openstreetmap.org during tests,\n  // we don't add the actual tile layer in that environment.\n  if (railsEnv !== 'test') layer.addTo(map);\n  if (iframeTrick) {\n    // We create an invisible iframe that triggers an invalidate size when\n    // resized (which includes bootstrap's collapse/hide/show events).\n    var iframe = document.createElement('iframe');\n    iframe.className = 'invisible-iframe-map';\n    iframe.src = 'about:blank';\n    document.getElementById(\"\".concat(elementId)).appendChild(iframe);\n    var listener = function listener() {\n      iframe.contentWindow.addEventListener('resize', function () {\n        map.invalidateSize();\n      });\n      map.invalidateSize();\n    };\n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n      // Call on next tick\n      setTimeout(listener, 1);\n    } else {\n      document.addEventListener('DOMContentLoaded', listener);\n    }\n  }\n  return map;\n};\nwindow.wca.removeMapMarkersLeaflet = function (map) {\n  map.eachLayer(function (layer) {\n    if (layer instanceof Marker) {\n      map.removeLayer(layer);\n    }\n  });\n};\nwindow.wca.addCompetitionsToMapLeaflet = function addCompToMap(map, competitions) {\n  competitions.forEach(function (c) {\n    var iconImage;\n    if (c.is_probably_over) {\n      iconImage = blueMarker;\n    } else {\n      iconImage = redMarker;\n    }\n    var competitionDesc = \"<a href=\".concat(c.url, \">\").concat(c.name, \"</a><br />\").concat(c.marker_date, \" - \").concat(c.cityName);\n    new Marker({\n      lat: c.latitude_degrees,\n      lng: c.longitude_degrees\n    }, {\n      title: c.name,\n      icon: iconImage\n    }).addTo(map).bindPopup(competitionDesc);\n  });\n};\nfunction roundToMicrodegrees(toRound) {\n  var val = toRound || 0;\n  // To prevent are you sure? from firing even when nothing has changed,\n  // explicitly round coordinates to an integer number of microdegrees.\n  return Math.trunc(parseFloat(val) * 1e6) / 1e6;\n}\nvar nearbyCompetitionsById = {};\nwindow.wca.setupVenueMap = function (elem, $lat, $lng, radiusDangerKm, radiusWarningKm, disabled) {\n  nearbyCompetitionsById = {};\n  var map = window.wca.createCompetitionsMapLeaflet(elem, [0, 0], false);\n  window.wca._venue_map = map;\n  var latLng = {\n    lat: $lat.val(),\n    lng: $lng.val()\n  };\n  // Create warning and danger circles\n  var circleDanger = new Circle(latLng, {\n    radius: radiusDangerKm * 1000,\n    fill: false,\n    color: '#d9534f' // @brand-danger\n  }).addTo(map);\n  var circleWarning = new Circle(latLng, {\n    radius: radiusWarningKm * 1000,\n    fill: false,\n    color: '#f0ad4e' // @brand-warning\n  }).addTo(map);\n  // Create competition marker\n  var compMarker = new Marker(latLng, {\n    draggable: !disabled\n  }).addTo(map);\n  var updateElementsPositions = function updateElementsPositions() {\n    var newPos = compMarker.getLatLng();\n    circleDanger.setLatLng(newPos);\n    circleWarning.setLatLng(newPos);\n    $lat.val(roundToMicrodegrees(newPos.lat));\n    $lng.val(roundToMicrodegrees(newPos.lng));\n    map.panTo(newPos);\n    window.wca.fetchNearbyCompetitions();\n  };\n  var inputChangeHandler = function inputChangeHandler() {\n    $lat.val(roundToMicrodegrees($lat.val()));\n    $lng.val(roundToMicrodegrees($lng.val()));\n    compMarker.setLatLng({\n      lat: $lat.val(),\n      lng: $lng.val()\n    });\n    // Elements position will be updated by the \"move\" handler\n  };\n  var updateOnExternalChange = function updateOnExternalChange(ev) {\n    if (ev.originalEvent) {\n      // This filters out mouse event, that are handled ondragend\n      return;\n    }\n    updateElementsPositions();\n  };\n  // Takes care of changes through setLatLng (change in input, or search result)\n  compMarker.on('move', updateOnExternalChange);\n  compMarker.on('dragend', updateElementsPositions);\n  $lat.change(inputChangeHandler);\n  $lng.change(inputChangeHandler);\n  // Center the view\n  map.setView(latLng, 8);\n  map.zoomControl.setPosition('topright');\n  if (!disabled) {\n    window.wca.createSearchInput(map);\n    var handleGeoSearchResult = function handleGeoSearchResult(result) {\n      compMarker.setLatLng({\n        lat: result.location.y,\n        lng: result.location.x\n      });\n      compMarker.bindPopup(result.location.label).openPopup();\n    };\n    map.on('geosearch/showlocation', handleGeoSearchResult);\n  }\n  return map;\n};\nwindow.wca.setNearbyCompetitions = function (nearbyCompetitions) {\n  var map = window.wca._venue_map;\n  var desiredNearbyCompetitionById = _keyBy(nearbyCompetitions, 'id');\n  var desiredIds = Object.keys(desiredNearbyCompetitionById);\n  var currentIds = Object.keys(nearbyCompetitionsById);\n  var idsToAdd = _difference(desiredIds, currentIds);\n  var idsToRemove = _difference(currentIds, desiredIds);\n\n  // First, remove all uneeded markers.\n  idsToRemove.forEach(function (id) {\n    map.removeLayer(nearbyCompetitionsById[id].marker);\n    delete nearbyCompetitionsById[id];\n  });\n\n  // Now create all the new markers.\n  idsToAdd.forEach(function (id) {\n    var c = desiredNearbyCompetitionById[id];\n    c.marker = new Marker({\n      lat: c.latitude_degrees,\n      lng: c.longitude_degrees\n    }, {\n      title: c.name\n    }).addTo(map);\n    nearbyCompetitionsById[id] = c;\n  });\n};","map":{"version":3,"names":["Map","LeafletMap","TileLayer","Marker","Circle","Popup","Icon","GeoSearchControl","iconMarker2x","iconMarker","iconShadow","railsEnv","redMarker","blueMarker","searchProvider","userTileProvider","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","window","wca","searchAndPlaceOnMap","map","query","search","then","allResults","length","result","lat","y","lng","x","title","label","addTo","bindPopup","openPopup","setView","setLatLng","setContent","openOn","createSearchInput","searchControl","provider","showMarker","showPopup","style","retainZoomLevel","autoClose","searchLabel","addControl","createCompetitionsMapLeaflet","elementId","center","arguments","undefined","iframeTrick","zoom","layer","url","maxZoom","attribution","iframe","document","createElement","className","src","getElementById","concat","appendChild","listener","contentWindow","addEventListener","invalidateSize","readyState","setTimeout","removeMapMarkersLeaflet","eachLayer","removeLayer","addCompetitionsToMapLeaflet","addCompToMap","competitions","forEach","c","iconImage","is_probably_over","competitionDesc","name","marker_date","cityName","latitude_degrees","longitude_degrees","icon","roundToMicrodegrees","toRound","val","Math","trunc","parseFloat","nearbyCompetitionsById","setupVenueMap","elem","$lat","$lng","radiusDangerKm","radiusWarningKm","disabled","_venue_map","latLng","circleDanger","radius","fill","color","circleWarning","compMarker","draggable","updateElementsPositions","newPos","getLatLng","panTo","fetchNearbyCompetitions","inputChangeHandler","updateOnExternalChange","ev","originalEvent","on","change","zoomControl","setPosition","handleGeoSearchResult","location","setNearbyCompetitions","nearbyCompetitions","desiredNearbyCompetitionById","_keyBy","desiredIds","Object","keys","currentIds","idsToAdd","_difference","idsToRemove","id","marker"],"sources":["/app/WcaOnRails/app/webpacker/lib/leaflet-wca/index.js"],"sourcesContent":["import 'leaflet/dist/leaflet.css';\n// https://github.com/smeijer/leaflet-geosearch/issues/151#issuecomment-347967474\nimport 'leaflet-geosearch/assets/css/leaflet.css';\nimport _ from 'lodash';\nimport {\n  Map as LeafletMap,\n  TileLayer,\n  Marker,\n  Circle,\n  Popup,\n  Icon,\n} from 'leaflet';\nimport { GeoSearchControl } from 'leaflet-geosearch';\nimport iconMarker2x from 'leaflet/dist/images/marker-icon-2x.png';\nimport iconMarker from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\nimport { railsEnv } from '../wca-data.js.erb';\nimport { redMarker, blueMarker } from './markers';\nimport { searchProvider, userTileProvider } from './providers';\n\n// Leaflet and webpack are not good friend, we need to require the images for\n// the assets to be properly setup.\n/* eslint no-underscore-dangle: \"off\" */\ndelete Icon.Default.prototype._getIconUrl;\nIcon.Default.mergeOptions({\n  iconRetinaUrl: iconMarker2x,\n  iconUrl: iconMarker,\n  shadowUrl: iconShadow,\n});\n\nwindow.wca.searchAndPlaceOnMap = (map, query) => {\n  searchProvider\n    .search({ query })\n    .then((allResults) => {\n      if (allResults.length > 0) {\n        // Assume first result will be ok\n        const result = allResults[0];\n        new Marker({\n          lat: result.y,\n          lng: result.x,\n        }, {\n          title: result.label,\n        }).addTo(map).bindPopup(result.label).openPopup();\n        map.setView([result.y, result.x], 16);\n      } else {\n        new Popup()\n          .setLatLng([0, 0])\n          .setContent('No location found for your query. Try with GPS coordinates.')\n          .openOn(map);\n      }\n    });\n};\n\n// Create a search input, removing any marker/popup added: we'll handle this ourselves\n// with the existing marker\nwindow.wca.createSearchInput = (map) => {\n  const searchControl = new GeoSearchControl({\n    provider: searchProvider,\n    showMarker: false,\n    showPopup: false,\n    style: 'bar',\n    retainZoomLevel: true,\n    autoClose: true,\n    searchLabel: 'Enter an address',\n  });\n  map.addControl(searchControl);\n  return searchControl;\n};\n\nwindow.wca.createCompetitionsMapLeaflet = (elementId, center = [0, 0], iframeTrick = true) => {\n  const map = new LeafletMap(elementId, {\n    zoom: 2,\n    center,\n  });\n  const provider = userTileProvider;\n  const layer = new TileLayer(provider.url, {\n    maxZoom: 19,\n    attribution: provider.attribution,\n  });\n  // To avoid timeout issue on *.tile.openstreetmap.org during tests,\n  // we don't add the actual tile layer in that environment.\n  if (railsEnv !== 'test') layer.addTo(map);\n  if (iframeTrick) {\n    // We create an invisible iframe that triggers an invalidate size when\n    // resized (which includes bootstrap's collapse/hide/show events).\n    const iframe = document.createElement('iframe');\n    iframe.className = 'invisible-iframe-map';\n    iframe.src = 'about:blank';\n    document.getElementById(`${elementId}`).appendChild(iframe);\n    const listener = () => {\n      iframe.contentWindow.addEventListener('resize', () => {\n        map.invalidateSize();\n      });\n      map.invalidateSize();\n    };\n\n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n      // Call on next tick\n      setTimeout(listener, 1);\n    } else {\n      document.addEventListener('DOMContentLoaded', listener);\n    }\n  }\n  return map;\n};\n\nwindow.wca.removeMapMarkersLeaflet = (map) => {\n  map.eachLayer((layer) => {\n    if (layer instanceof Marker) {\n      map.removeLayer(layer);\n    }\n  });\n};\n\nwindow.wca.addCompetitionsToMapLeaflet = function addCompToMap(map, competitions) {\n  competitions.forEach((c) => {\n    let iconImage;\n    if (c.is_probably_over) {\n      iconImage = blueMarker;\n    } else {\n      iconImage = redMarker;\n    }\n\n    const competitionDesc = `<a href=${c.url}>${c.name}</a><br />${c.marker_date} - ${c.cityName}`;\n    new Marker({\n      lat: c.latitude_degrees,\n      lng: c.longitude_degrees,\n    }, {\n      title: c.name,\n      icon: iconImage,\n    }).addTo(map).bindPopup(competitionDesc);\n  });\n};\n\nfunction roundToMicrodegrees(toRound) {\n  const val = toRound || 0;\n  // To prevent are you sure? from firing even when nothing has changed,\n  // explicitly round coordinates to an integer number of microdegrees.\n  return Math.trunc(parseFloat(val) * 1e6) / 1e6;\n}\n\nlet nearbyCompetitionsById = {};\n\nwindow.wca.setupVenueMap = (elem, $lat, $lng, radiusDangerKm, radiusWarningKm, disabled) => {\n  nearbyCompetitionsById = {};\n  const map = window.wca.createCompetitionsMapLeaflet(elem, [0, 0], false);\n  window.wca._venue_map = map;\n  const latLng = { lat: $lat.val(), lng: $lng.val() };\n  // Create warning and danger circles\n  const circleDanger = new Circle(latLng, {\n    radius: radiusDangerKm * 1000,\n    fill: false,\n    color: '#d9534f', // @brand-danger\n  }).addTo(map);\n  const circleWarning = new Circle(latLng, {\n    radius: radiusWarningKm * 1000,\n    fill: false,\n    color: '#f0ad4e', // @brand-warning\n  }).addTo(map);\n  // Create competition marker\n  const compMarker = new Marker(latLng, {\n    draggable: !disabled,\n  }).addTo(map);\n  const updateElementsPositions = () => {\n    const newPos = compMarker.getLatLng();\n    circleDanger.setLatLng(newPos);\n    circleWarning.setLatLng(newPos);\n    $lat.val(roundToMicrodegrees(newPos.lat));\n    $lng.val(roundToMicrodegrees(newPos.lng));\n    map.panTo(newPos);\n    window.wca.fetchNearbyCompetitions();\n  };\n\n  const inputChangeHandler = () => {\n    $lat.val(roundToMicrodegrees($lat.val()));\n    $lng.val(roundToMicrodegrees($lng.val()));\n    compMarker.setLatLng({\n      lat: $lat.val(),\n      lng: $lng.val(),\n    });\n    // Elements position will be updated by the \"move\" handler\n  };\n  const updateOnExternalChange = (ev) => {\n    if (ev.originalEvent) {\n      // This filters out mouse event, that are handled ondragend\n      return;\n    }\n    updateElementsPositions();\n  };\n  // Takes care of changes through setLatLng (change in input, or search result)\n  compMarker.on('move', updateOnExternalChange);\n  compMarker.on('dragend', updateElementsPositions);\n  $lat.change(inputChangeHandler);\n  $lng.change(inputChangeHandler);\n  // Center the view\n  map.setView(latLng, 8);\n  map.zoomControl.setPosition('topright');\n  if (!disabled) {\n    window.wca.createSearchInput(map);\n    const handleGeoSearchResult = (result) => {\n      compMarker.setLatLng({\n        lat: result.location.y,\n        lng: result.location.x,\n      });\n      compMarker.bindPopup(result.location.label).openPopup();\n    };\n    map.on('geosearch/showlocation', handleGeoSearchResult);\n  }\n  return map;\n};\n\nwindow.wca.setNearbyCompetitions = (nearbyCompetitions) => {\n  const map = window.wca._venue_map;\n  const desiredNearbyCompetitionById = _.keyBy(nearbyCompetitions, 'id');\n\n  const desiredIds = Object.keys(desiredNearbyCompetitionById);\n  const currentIds = Object.keys(nearbyCompetitionsById);\n  const idsToAdd = _.difference(desiredIds, currentIds);\n  const idsToRemove = _.difference(currentIds, desiredIds);\n\n  // First, remove all uneeded markers.\n  idsToRemove.forEach((id) => {\n    map.removeLayer(nearbyCompetitionsById[id].marker);\n    delete nearbyCompetitionsById[id];\n  });\n\n  // Now create all the new markers.\n  idsToAdd.forEach((id) => {\n    const c = desiredNearbyCompetitionById[id];\n    c.marker = new Marker({\n      lat: c.latitude_degrees,\n      lng: c.longitude_degrees,\n    }, {\n      title: c.name,\n    }).addTo(map);\n    nearbyCompetitionsById[id] = c;\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}