{"ast":null,"code":"import _toInteger from \"lodash/toInteger\";\nvar _jsxFileName = \"/app/WcaOnRails/app/webpacker/components/Results/WCALive/AttemptResultField/MbldPointsField.js\";\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport React, { useState, useCallback } from 'react';\nimport { Form } from 'semantic-ui-react';\nimport { SKIPPED_VALUE } from \"../../../../lib/wca-live/attempts\";\nimport { attemptResultToMbPoints, mbPointsToAttemptResultWithUnknownTime } from \"../../../../lib/utils/edit-events\";\nvar MAX_POINTS = 99;\nfunction numberToInput(number) {\n  if (number === SKIPPED_VALUE) return '';\n  return number.toString();\n}\n\n/* eslint react/jsx-props-no-spreading: \"off\" */\nfunction MbldPointsField(_ref) {\n  var rawValue = _ref.value,\n    onChange = _ref.onChange,\n    label = _ref.label,\n    disabled = _ref.disabled,\n    _ref$TextFieldProps = _ref.TextFieldProps,\n    TextFieldProps = _ref$TextFieldProps === void 0 ? {} : _ref$TextFieldProps;\n  var value = attemptResultToMbPoints(rawValue);\n  var _useState = useState(value),\n    _useState2 = _slicedToArray(_useState, 2),\n    prevValue = _useState2[0],\n    setPrevValue = _useState2[1];\n  var _useState3 = useState(value),\n    _useState4 = _slicedToArray(_useState3, 2),\n    draftValue = _useState4[0],\n    setDraftValue = _useState4[1];\n\n  // Sync draft value when the upstream value changes.\n  // See AttemptResultField for detailed description.\n  if (prevValue !== value) {\n    setDraftValue(value);\n    setPrevValue(value);\n  }\n  var handleChange = useCallback(function (event) {\n    var newValue = _toInteger(event.target.value.replace(/\\D/g, '')) || SKIPPED_VALUE;\n    setDraftValue(Math.min(MAX_POINTS, newValue));\n  }, [setDraftValue]);\n  var handleBlur = useCallback(function () {\n    var parsedDraftValue = mbPointsToAttemptResultWithUnknownTime(draftValue);\n    onChange(parsedDraftValue);\n    // Once we emit the change, reflect the initial state.\n    setDraftValue(value);\n  }, [onChange, draftValue, setDraftValue, value]);\n  return /*#__PURE__*/React.createElement(Form.Input, Object.assign({}, TextFieldProps, {\n    label: label,\n    disabled: disabled,\n    spellCheck: false,\n    value: numberToInput(draftValue),\n    onChange: handleChange,\n    onBlur: handleBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 5\n    }\n  }));\n}\nexport default MbldPointsField;","map":{"version":3,"names":["React","useState","useCallback","Form","SKIPPED_VALUE","attemptResultToMbPoints","mbPointsToAttemptResultWithUnknownTime","MAX_POINTS","numberToInput","number","toString","MbldPointsField","_ref","rawValue","value","onChange","label","disabled","_ref$TextFieldProps","TextFieldProps","_useState","_useState2","_slicedToArray","prevValue","setPrevValue","_useState3","_useState4","draftValue","setDraftValue","handleChange","event","newValue","_toInteger","target","replace","Math","min","handleBlur","parsedDraftValue","createElement","Input","Object","assign","spellCheck","onBlur","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/app/WcaOnRails/app/webpacker/components/Results/WCALive/AttemptResultField/MbldPointsField.js"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { Form } from 'semantic-ui-react';\nimport _ from 'lodash';\nimport { SKIPPED_VALUE } from '../../../../lib/wca-live/attempts';\nimport {\n  attemptResultToMbPoints,\n  mbPointsToAttemptResultWithUnknownTime,\n} from '../../../../lib/utils/edit-events';\n\nconst MAX_POINTS = 99;\n\nfunction numberToInput(number) {\n  if (number === SKIPPED_VALUE) return '';\n  return number.toString();\n}\n\n/* eslint react/jsx-props-no-spreading: \"off\" */\nfunction MbldPointsField({\n  value: rawValue, onChange, label, disabled, TextFieldProps = {},\n}) {\n  const value = attemptResultToMbPoints(rawValue);\n  const [prevValue, setPrevValue] = useState(value);\n  const [draftValue, setDraftValue] = useState(value);\n\n  // Sync draft value when the upstream value changes.\n  // See AttemptResultField for detailed description.\n  if (prevValue !== value) {\n    setDraftValue(value);\n    setPrevValue(value);\n  }\n\n  const handleChange = useCallback((event) => {\n    const newValue = _.toInteger(event.target.value.replace(/\\D/g, '')) || SKIPPED_VALUE;\n    setDraftValue(Math.min(MAX_POINTS, newValue));\n  }, [setDraftValue]);\n\n  const handleBlur = useCallback(() => {\n    const parsedDraftValue = mbPointsToAttemptResultWithUnknownTime(draftValue);\n    onChange(parsedDraftValue);\n    // Once we emit the change, reflect the initial state.\n    setDraftValue(value);\n  }, [onChange, draftValue, setDraftValue, value]);\n\n  return (\n    <Form.Input\n      {...TextFieldProps}\n      label={label}\n      disabled={disabled}\n      spellCheck={false}\n      value={numberToInput(draftValue)}\n      onChange={handleChange}\n      onBlur={handleBlur}\n    />\n  );\n}\n\nexport default MbldPointsField;\n"],"mappings":";;;;;;;;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AACpD,SAASC,IAAI,QAAQ,mBAAmB;AAExC,SAASC,aAAa;AACtB,SACEC,uBAAuB,EACvBC,sCAAsC;AAGxC,IAAMC,UAAU,GAAG,EAAE;AAErB,SAASC,aAAaA,CAACC,MAAM,EAAE;EAC7B,IAAIA,MAAM,KAAKL,aAAa,EAAE,OAAO,EAAE;EACvC,OAAOK,MAAM,CAACC,QAAQ,CAAC,CAAC;AAC1B;;AAEA;AACA,SAASC,eAAeA,CAAAC,IAAA,EAErB;EAAA,IADMC,QAAQ,GAAAD,IAAA,CAAfE,KAAK;IAAYC,QAAQ,GAAAH,IAAA,CAARG,QAAQ;IAAEC,KAAK,GAAAJ,IAAA,CAALI,KAAK;IAAEC,QAAQ,GAAAL,IAAA,CAARK,QAAQ;IAAAC,mBAAA,GAAAN,IAAA,CAAEO,cAAc;IAAdA,cAAc,GAAAD,mBAAA,cAAG,CAAC,CAAC,GAAAA,mBAAA;EAE/D,IAAMJ,KAAK,GAAGT,uBAAuB,CAACQ,QAAQ,CAAC;EAC/C,IAAAO,SAAA,GAAkCnB,QAAQ,CAACa,KAAK,CAAC;IAAAO,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA1CG,SAAS,GAAAF,UAAA;IAAEG,YAAY,GAAAH,UAAA;EAC9B,IAAAI,UAAA,GAAoCxB,QAAQ,CAACa,KAAK,CAAC;IAAAY,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAA5CE,UAAU,GAAAD,UAAA;IAAEE,aAAa,GAAAF,UAAA;;EAEhC;EACA;EACA,IAAIH,SAAS,KAAKT,KAAK,EAAE;IACvBc,aAAa,CAACd,KAAK,CAAC;IACpBU,YAAY,CAACV,KAAK,CAAC;EACrB;EAEA,IAAMe,YAAY,GAAG3B,WAAW,CAAC,UAAC4B,KAAK,EAAK;IAC1C,IAAMC,QAAQ,GAAGC,UAAA,CAAYF,KAAK,CAACG,MAAM,CAACnB,KAAK,CAACoB,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,IAAI9B,aAAa;IACpFwB,aAAa,CAACO,IAAI,CAACC,GAAG,CAAC7B,UAAU,EAAEwB,QAAQ,CAAC,CAAC;EAC/C,CAAC,EAAE,CAACH,aAAa,CAAC,CAAC;EAEnB,IAAMS,UAAU,GAAGnC,WAAW,CAAC,YAAM;IACnC,IAAMoC,gBAAgB,GAAGhC,sCAAsC,CAACqB,UAAU,CAAC;IAC3EZ,QAAQ,CAACuB,gBAAgB,CAAC;IAC1B;IACAV,aAAa,CAACd,KAAK,CAAC;EACtB,CAAC,EAAE,CAACC,QAAQ,EAAEY,UAAU,EAAEC,aAAa,EAAEd,KAAK,CAAC,CAAC;EAEhD,oBACEd,KAAA,CAAAuC,aAAA,CAACpC,IAAI,CAACqC,KAAK,EAAAC,MAAA,CAAAC,MAAA,KACLvB,cAAc;IAClBH,KAAK,EAAEA,KAAM;IACbC,QAAQ,EAAEA,QAAS;IACnB0B,UAAU,EAAE,KAAM;IAClB7B,KAAK,EAAEN,aAAa,CAACmB,UAAU,CAAE;IACjCZ,QAAQ,EAAEc,YAAa;IACvBe,MAAM,EAAEP,UAAW;IAAAQ,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,EACpB,CAAC;AAEN;AAEA,eAAevC,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}