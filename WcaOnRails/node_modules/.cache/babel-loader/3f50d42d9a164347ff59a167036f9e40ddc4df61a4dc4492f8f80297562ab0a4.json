{"ast":null,"code":"var _jsxFileName = \"/app/WcaOnRails/app/webpacker/components/RolesTab/index.jsx\";\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nimport React from 'react';\nimport { Modal, Button } from 'semantic-ui-react';\nimport useLoadedData from \"../../lib/hooks/useLoadedData\";\nimport { apiV0Urls } from \"../../lib/requests/routes.js.erb\";\nimport Errored from \"../Requests/Errored\";\nimport Loading from \"../Requests/Loading\";\nimport RoleForm from \"./RoleForm\";\nimport { groupTypes } from \"../../lib/wca-data.js.erb\";\nimport ActiveRoles from \"./ActiveRoles\";\nimport PastRoles from \"./PastRoles\";\n\n// let i18n-tasks know the key is used\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.trainee_delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.candidate_delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.regional_delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.senior_delegate')\n// i18n-tasks-use t('enums.user.role_status.teams_committees.member')\n// i18n-tasks-use t('enums.user.role_status.teams_committees.senior_member')\n// i18n-tasks-use t('enums.user.role_status.teams_committees.leader')\n// i18n-tasks-use t('enums.user.role_status.councils.member')\n// i18n-tasks-use t('enums.user.role_status.councils.senior_member')\n// i18n-tasks-use t('enums.user.role_status.councils.leader')\n\nvar sortParams = 'status';\nexport default function RolesTab(_ref) {\n  var userId = _ref.userId;\n  var _useLoadedData = useLoadedData(apiV0Urls.userRoles.listOfUser(userId, sortParams, {\n      isActive: true,\n      isGroupHidden: false\n    })),\n    activeRoles = _useLoadedData.data,\n    activeRolesLoading = _useLoadedData.loading,\n    activeRolesError = _useLoadedData.error,\n    activeRolesSync = _useLoadedData.sync;\n  var _useLoadedData2 = useLoadedData(apiV0Urls.userRoles.listOfUser(userId, sortParams, {\n      isActive: false,\n      isGroupHidden: false\n    })),\n    pastRoles = _useLoadedData2.data,\n    pastRolesLoading = _useLoadedData2.loading,\n    pastRolesError = _useLoadedData2.error,\n    pastRolesSync = _useLoadedData2.sync;\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    open = _React$useState2[0],\n    setOpen = _React$useState2[1];\n  var isDelegate = activeRoles === null || activeRoles === void 0 ? void 0 : activeRoles.some(function (role) {\n    return role.group.group_type === groupTypes.delegate_regions;\n  });\n  var hasNoRoles = (activeRoles === null || activeRoles === void 0 ? void 0 : activeRoles.length) === 0 && (pastRoles === null || pastRoles === void 0 ? void 0 : pastRoles.length) === 0;\n  if (activeRolesLoading || pastRolesLoading) return /*#__PURE__*/React.createElement(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 54\n    }\n  });\n  if (activeRolesError || pastRolesError) return /*#__PURE__*/React.createElement(Errored, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 50\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, (activeRoles === null || activeRoles === void 0 ? void 0 : activeRoles.length) > 0 && /*#__PURE__*/React.createElement(ActiveRoles, {\n    activeRoles: activeRoles,\n    setOpen: setOpen,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 36\n    }\n  }), (pastRoles === null || pastRoles === void 0 ? void 0 : pastRoles.length) > 0 && /*#__PURE__*/React.createElement(PastRoles, {\n    pastRoles: pastRoles,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 34\n    }\n  }), hasNoRoles && /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 22\n    }\n  }, \"No Roles...\"), /*#__PURE__*/React.createElement(Button, {\n    onClick: function onClick() {\n      return setOpen(true);\n    },\n    disabled: isDelegate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }, \"New Role\"), /*#__PURE__*/React.createElement(Modal, {\n    size: \"fullscreen\",\n    onClose: function onClose() {\n      setOpen(false);\n      activeRolesSync();\n      pastRolesSync();\n      window.location.reload(); // TODO: This is a hack to force the page to reload after\n      // closing the modal, so that avatar tab will be visible. A common use case of a\n      // Senior Delegate is that after creating a new delegate, they will want to crop the\n      // thumbnail. But the avatar tab is not visible until the page is reloaded because that\n      // part of code is still in erb. This can be fixed while migrating completely to React.\n    },\n    open: open,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(RoleForm, {\n    userId: userId,\n    isActiveRole: isDelegate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 11\n    }\n  }))));\n}","map":{"version":3,"names":["React","Modal","Button","useLoadedData","apiV0Urls","Errored","Loading","RoleForm","groupTypes","ActiveRoles","PastRoles","sortParams","RolesTab","_ref","userId","_useLoadedData","userRoles","listOfUser","isActive","isGroupHidden","activeRoles","data","activeRolesLoading","loading","activeRolesError","error","activeRolesSync","sync","_useLoadedData2","pastRoles","pastRolesLoading","pastRolesError","pastRolesSync","_React$useState","useState","_React$useState2","_slicedToArray","open","setOpen","isDelegate","some","role","group","group_type","delegate_regions","hasNoRoles","length","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Fragment","onClick","disabled","size","onClose","window","location","reload","Content","isActiveRole"],"sources":["/app/WcaOnRails/app/webpacker/components/RolesTab/index.jsx"],"sourcesContent":["import React from 'react';\nimport { Modal, Button } from 'semantic-ui-react';\nimport useLoadedData from '../../lib/hooks/useLoadedData';\nimport { apiV0Urls } from '../../lib/requests/routes.js.erb';\nimport Errored from '../Requests/Errored';\nimport Loading from '../Requests/Loading';\nimport RoleForm from './RoleForm';\nimport { groupTypes } from '../../lib/wca-data.js.erb';\nimport ActiveRoles from './ActiveRoles';\nimport PastRoles from './PastRoles';\n\n// let i18n-tasks know the key is used\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.trainee_delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.candidate_delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.regional_delegate')\n// i18n-tasks-use t('enums.user.role_status.delegate_regions.senior_delegate')\n// i18n-tasks-use t('enums.user.role_status.teams_committees.member')\n// i18n-tasks-use t('enums.user.role_status.teams_committees.senior_member')\n// i18n-tasks-use t('enums.user.role_status.teams_committees.leader')\n// i18n-tasks-use t('enums.user.role_status.councils.member')\n// i18n-tasks-use t('enums.user.role_status.councils.senior_member')\n// i18n-tasks-use t('enums.user.role_status.councils.leader')\n\nconst sortParams = 'status';\n\nexport default function RolesTab({ userId }) {\n  const {\n    data: activeRoles,\n    loading: activeRolesLoading,\n    error: activeRolesError,\n    sync: activeRolesSync,\n  } = useLoadedData(apiV0Urls.userRoles.listOfUser(\n    userId,\n    sortParams,\n    { isActive: true, isGroupHidden: false },\n  ));\n  const {\n    data: pastRoles,\n    loading: pastRolesLoading,\n    error: pastRolesError,\n    sync: pastRolesSync,\n  } = useLoadedData(apiV0Urls.userRoles.listOfUser(\n    userId,\n    sortParams,\n    { isActive: false, isGroupHidden: false },\n  ));\n\n  const [open, setOpen] = React.useState(false);\n\n  const isDelegate = activeRoles?.some(\n    (role) => role.group.group_type === groupTypes.delegate_regions,\n  );\n\n  const hasNoRoles = activeRoles?.length === 0 && pastRoles?.length === 0;\n\n  if (activeRolesLoading || pastRolesLoading) return <Loading />;\n  if (activeRolesError || pastRolesError) return <Errored />;\n\n  return (\n    <>\n      {activeRoles?.length > 0 && (<ActiveRoles activeRoles={activeRoles} setOpen={setOpen} />)}\n      {pastRoles?.length > 0 && (<PastRoles pastRoles={pastRoles} />)}\n      {hasNoRoles && <p>No Roles...</p>}\n      <Button onClick={() => setOpen(true)} disabled={isDelegate}>New Role</Button>\n\n      <Modal\n        size=\"fullscreen\"\n        onClose={() => {\n          setOpen(false);\n          activeRolesSync();\n          pastRolesSync();\n          window.location.reload(); // TODO: This is a hack to force the page to reload after\n          // closing the modal, so that avatar tab will be visible. A common use case of a\n          // Senior Delegate is that after creating a new delegate, they will want to crop the\n          // thumbnail. But the avatar tab is not visible until the page is reloaded because that\n          // part of code is still in erb. This can be fixed while migrating completely to React.\n        }}\n        open={open}\n      >\n        <Modal.Content>\n          <RoleForm userId={userId} isActiveRole={isDelegate} />\n        </Modal.Content>\n      </Modal>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}